

# 지도 포함 배민커넥트/쿠팡이츠 스타일 전면 재구성

업로드된 스크린샷과 거의 동일한 UI/UX를 구현하되, 배달 대신 다양한 오프라인 요청(촬영, 조사, 확인 등)에 대응하는 Worker 앱으로 구축합니다.

---

## 지도 구현 방식

API 키 없이 사용할 수 있는 **Leaflet + OpenStreetMap**을 사용합니다.
- `leaflet` + `react-leaflet` 패키지 설치
- 무료, API 키 불필요, 한국 지도 지원
- 현재 위치 마커 + 주변 Job 마커 표시

---

## 핵심 화면별 구현 계획

### 1. 홈 화면 - 지도 + 상태 토글 + 수익 (이미지 1, 9)

배민커넥트 홈처럼 전체 화면 지도 위에 오버레이 UI를 배치합니다.

```text
+------------------------------------------+
|  Human Node                    🔔  👤    |
+==========================================+
|                                          |
|        [ 지도 - 전체 화면 ]              |
|          📍 현재 위치                    |
|          🔵 Job 마커들                   |
|                                          |
+------------------------------------------+
|  ┌────────────────────────────────────┐  |  <- 지도 위 오버레이
|  │  🟢 일감을 찾고 있어요        ●○  │  |
|  └────────────────────────────────────┘  |
+------------------------------------------+
|  오늘 수익                               |
|  ₩ 75,000        3건 완료               |
|  ━━━━━━━━━━━━━━━ 목표 100,000원         |
+------------------------------------------+
|  이번 주 수익                             |
|  월 ■■  화 ■■■  수 ■■■■  목 ■  금      |
+------------------------------------------+
|  홈    Jobs    활동    마이               |
+------------------------------------------+
```

**구현 파일:**
- `src/pages/Home.tsx` - 전면 재구성 (지도 + 오버레이)
- `src/components/home/HomeMap.tsx` - Leaflet 지도 (Job 마커 포함)
- `src/components/home/StatusToggle.tsx` - 온/오프라인 토글
- `src/components/home/TodayEarnings.tsx` - 수익 요약 + 프로그레스 바
- `src/components/home/WeeklyChart.tsx` - 주간 바 차트 (recharts)

### 2. Job 콜 화면 - 하단 시트 수락/거절 (이미지 2, 3)

Jobs 탭에서 카드를 누르면 쿠팡이츠 스타일 하단 시트가 올라옵니다.

```text
+------------------------------------------+
|  Jobs                        거리순 ▼    |
+------------------------------------------+
|  [전체] [AI] [사람] [파트너]             |
+------------------------------------------+
|  실시간 Job 6건                          |
|  +------------------------------------+  |
|  | 🤖 AI  현장 촬영                   |  |
|  | 강남역 2번 출구  1.2km  30분       |  |
|  | ₩25,000            [수락하기]      |  |
|  +------------------------------------+  |
+==========================================+
|  <<< 카드 터치 시 Bottom Sheet >>>       |
|                                          |
|      강남역 건물 외관 촬영               |
|         25,000원                         |
|   거리혜택 · 추가 수수료 포함 ⓘ         |
|   현재 위치에서 1.2km ⓘ                 |
|                                          |
|  진행되는 미션 2개                       |
|  ┌──────────────────────────────┐        |
|  │ 9건 더 하면 1만원            │        |
|  └──────────────────────────────┘        |
|                                          |
|  [ 거절 ]        [ 수락 | 31초 ]         |
+------------------------------------------+
```

**구현 파일:**
- `src/pages/Jobs.tsx` - 리스트 + Sheet 연동
- `src/components/jobs/JobCard.tsx` - 인라인 수락 버튼 포함 카드
- `src/components/jobs/JobCallSheet.tsx` - vaul Drawer 기반 콜 시트 (카운트다운 타이머)

### 3. Job 수행 화면 - 위치 상세 + 찾기 팁 (이미지 4, 5)

Job 수락 후 전용 수행 페이지로 이동합니다. 지도 + 위치 정보 + 찾기 팁을 표시합니다.

```text
+------------------------------------------+
|  ← 현장 촬영  JOB001              📞    |
+------------------------------------------+
|        [ 지도 - 목적지 표시 ]            |
|          📍 강남역 2번 출구               |
+------------------------------------------+
|  강남역 건물 외관 촬영                    |
|  서울 강남구 강남대로 396          [복사]  |
+------------------------------------------+
|  🏠 현장 찾기 팁                         |
|  강남역 2번 출구에서 직진 300m,           |
|  우측 유리 건물 3층                       |
+------------------------------------------+
|  🅿️ 주차/접근 팁                         |
|  건물 지하주차장 이용 가능                |
+------------------------------------------+
|        배정 취소하기                      |
|  📞 지원센터에 전화                      |
+------------------------------------------+
|  [       현장 도착       ]               |
+------------------------------------------+
```

**구현 파일:**
- `src/pages/JobProgress.tsx` - 수행 전체 페이지 (단계별 UI)
- `src/components/jobs/JobProgressMap.tsx` - 목적지 지도
- `src/components/jobs/JobLocationInfo.tsx` - 주소 + 찾기 팁

### 4. 수행 중 + 증빙 촬영 (이미지 6, 7, 8)

현장 도착 후 요청 내용 확인, 수행, 증빙 제출까지의 흐름입니다.

```text
+------------------------------------------+
|  ← 수행중  JOB001                  📞   |
+------------------------------------------+
|  강남역 건물 외관 촬영                    |
|  서울 강남구 강남대로 396          [복사]  |
+------------------------------------------+
|  👤 요청자 메모                          |
|  ┌──────────────────────────────┐        |
|  │ "정면 사진은 건물 전체가     │        |
|  │  나오도록 촬영해주세요."     │        |
|  └──────────────────────────────┘        |
+------------------------------------------+
|  수행 내역                               |
|  건물 외관 촬영 5장              -       |
|  보수                      25,000원      |
+------------------------------------------+
|  완료 후 증빙 사진을 꼭 찍어주세요        |
+------------------------------------------+
|  [       증빙 촬영       ]               |
+------------------------------------------+
```

증빙 촬영 버튼 누르면:

```text
+------------------------------------------+
|  ←  증빙 촬영                            |
+------------------------------------------+
|                                          |
|       [ 촬영된 사진 미리보기 ]           |
|                                          |
+------------------------------------------+
|  완료 사진은 요청자에게 전달됩니다.       |
|  문제 발생 시 증빙으로 사용됩니다.        |
+------------------------------------------+
|          ↻ 사진 다시 촬영                |
+------------------------------------------+
|  [       수행 완료       ]               |
+------------------------------------------+
```

**구현 파일:**
- `src/pages/JobProgress.tsx` 내 단계별 렌더링 (CLAIMED -> IN_PROGRESS -> SUBMITTED)
- `src/components/jobs/EvidenceUpload.tsx` - 사진 업로드 UI

### 5. 완료 정산 시트 (이미지 9)

```text
+------------------------------------------+
|      강남역 건물 외관 촬영 완료           |
|            25,000원                      |
|                                          |
|  기본 수수료              20,000원       |
|  추가 수수료              +5,000원       |
+------------------------------------------+
|  진행한 미션 1개                         |
|  ┌──────────────────────────────┐        |
|  │ 9건 더 하면 1만원     10건 > │        |
|  └──────────────────────────────┘        |
+------------------------------------------+
|  [          확인          ]              |
+------------------------------------------+
```

**구현 파일:**
- `src/components/jobs/JobCompleteSheet.tsx` - 정산 하단 시트

### 6. 활동 내역 페이지

```text
+------------------------------------------+
|  활동 내역                               |
+------------------------------------------+
|  [진행중 1] [완료] [취소]                |
+------------------------------------------+
|  --- 진행중 ---                          |
|  +------------------------------------+  |
|  | 🤖 행사장 현수막 설치 확인         |  |
|  | 코엑스 A홀  |  수행중              |  |
|  | [  증빙 제출하기  ]                 |  |
|  +------------------------------------+  |
|                                          |
|  --- 2월 9일 ---                         |
|  +------------------------------------+  |
|  | ✅ 건물 외관 촬영    ₩25,000       |  |
|  | 완료 14:32                          |  |
|  +------------------------------------+  |
+------------------------------------------+
```

**구현 파일:**
- `src/pages/Activity.tsx` - 활동 탭
- `src/components/activity/ActivityCard.tsx` - 내역 카드

### 7. GNB 업데이트

홈 | Jobs | 활동 | 마이 (Workers 탭 제거)

---

## 전체 파일 목록 (19개)

### 새로 생성 (12개)
1. `src/components/home/HomeMap.tsx` - Leaflet 지도 (현위치 + Job 마커)
2. `src/components/home/StatusToggle.tsx` - 온/오프 토글
3. `src/components/home/TodayEarnings.tsx` - 오늘 수익 카드
4. `src/components/home/WeeklyChart.tsx` - 주간 차트
5. `src/components/jobs/JobCallSheet.tsx` - 콜 수락 하단 시트
6. `src/components/jobs/JobProgressMap.tsx` - 수행 중 지도
7. `src/components/jobs/JobLocationInfo.tsx` - 위치 + 찾기 팁
8. `src/components/jobs/EvidenceUpload.tsx` - 증빙 촬영 UI
9. `src/components/jobs/JobCompleteSheet.tsx` - 완료 정산 시트
10. `src/pages/JobProgress.tsx` - Job 수행 페이지
11. `src/pages/Activity.tsx` - 활동 내역
12. `src/components/activity/ActivityCard.tsx` - 활동 카드

### 수정 (7개)
13. `src/pages/Home.tsx` - 지도 중심 대시보드로 전면 재구성
14. `src/pages/Jobs.tsx` - 인라인 수락 + Sheet 연동
15. `src/components/jobs/JobCard.tsx` - 수락 버튼 포함 카드
16. `src/components/layout/BottomNav.tsx` - 활동 탭 추가
17. `src/App.tsx` - /activity, /jobs/:id/progress 라우트 추가
18. `src/data/mockJobs.ts` - 찾기 팁, 주차 정보 등 필드 추가
19. `src/types/job.ts` - findingTip, parkingTip, requesterNote 필드 추가

### 패키지 설치
- `leaflet` + `react-leaflet` + `@types/leaflet`

---

## 기술 세부사항

### Leaflet 지도 설정
- OpenStreetMap 타일 사용 (무료, API 키 불필요)
- 서울 강남 중심 좌표 기본값 (37.498, 127.027)
- Job 위치를 커스텀 마커로 표시 (카테고리별 아이콘)
- CSS import: `leaflet/dist/leaflet.css`

### Job 상태 흐름

```text
POSTED -> (수락) -> CLAIMED -> (현장도착) -> IN_PROGRESS -> (증빙제출) -> SUBMITTED -> APPROVED/PAID
```

각 상태에 따라 JobProgress 페이지의 UI가 자동 전환됩니다.

### 카운트다운 타이머 (JobCallSheet)
- useEffect + setInterval로 31초 카운트다운
- 0초 도달 시 자동 닫힘
- 수락 버튼에 남은 시간 표시

### Mock 데이터 확장 (job.ts)
```typescript
// 추가 필드
finding_tip?: string;      // "2번 출구에서 직진 300m"
parking_tip?: string;      // "지하주차장 이용 가능"
requester_note?: string;   // "건물 전체가 나오도록 촬영"
deliverables?: string[];   // ["외관 사진 5장", "입구 근접 사진 2장"]
```
